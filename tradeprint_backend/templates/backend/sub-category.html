{% extends "backend/themes/base.html" %}
{% load static %}

{% block content %}
<!-- PAGE WRAPPER -->
<div class="ec-page-wrapper">

	<!-- Header -->
	<header class="ec-main-header" id="header">
		<nav class="navbar navbar-static-top navbar-expand-lg">
			<!-- Sidebar toggle button -->
			<button id="sidebar-toggler" class="sidebar-toggle"></button>
			<!-- search form -->
			<div class="search-form d-lg-inline-block">
				<div class="input-group">
					<input type="text" name="query" id="search-input" class="form-control" placeholder="search.."
						autofocus autocomplete="off" />
					<button type="button" name="search" id="search-btn" class="btn btn-flat">
						<i class="mdi mdi-magnify"></i>
					</button>
				</div>
				<div id="search-results-container">
					<ul id="search-results"></ul>
				</div>
			</div>

			<!-- navbar right -->
			<div class="navbar-right">
				<ul class="nav navbar-nav">
					<!-- User Account -->
					<li class="dropdown user-menu">
						<button class="dropdown-toggle nav-link ec-drop" data-bs-toggle="dropdown"
							aria-expanded="false">
							<img src="assets/img/user/user.png" class="user-image" alt="User Image" />
						</button>
						<ul class="dropdown-menu dropdown-menu-right ec-dropdown-menu">
							<!-- User image -->
							<li class="dropdown-header">
								<img src="assets/img/user/user.png" class="img-circle" alt="User Image" />
								<div class="d-inline-block">
									John Deo <small class="pt-1">john.example@gmail.com</small>
								</div>
							</li>
							<li>
								<a href="user-profile.html">
									<i class="mdi mdi-account"></i> My Profile
								</a>
							</li>

							<li class="dropdown-footer">
								<a href="index.html"> <i class="mdi mdi-logout"></i> Log Out </a>
							</li>
						</ul>
					</li>

				</ul>
			</div>
		</nav>
	</header>

	<!-- CONTENT WRAPPER -->
	<div class="ec-content-wrapper">
		<div class="content">
			<div class="breadcrumb-wrapper breadcrumb-wrapper-2 breadcrumb-contacts">
				<h1>Sub Category</h1>
				<p class="breadcrumbs"><span><a href="index.html">Home</a></span>
					<span><i class="mdi mdi-chevron-right"></i></span>Sub Category
				</p>
			</div>

			{% if messages %}
			{% for message in messages %}
			<div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
				{{ message }}
				<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
			</div>
			{% endfor %}
			{% endif %}

			<div class="row">
				<div class="col-xl-4 col-lg-12">
					<div class="ec-cat-list card card-default mb-24px">
						<div class="card-body">
							<div class="ec-cat-form">
								<h4>{% if editing %}Edit{% else %}Add{% endif %} Sub Category</h4>

								<form method="POST">
									{% csrf_token %}

									<div class="form-group row">
										<label class="col-12 col-form-label">Name <span
												class="text-danger">*</span></label>
										<div class="col-12">
											{{ form.name }}
											{% if form.name.errors %}
											<div class="text-danger mt-1">{{ form.name.errors }}</div>
											{% endif %}
										</div>
									</div>

									<div class="form-group row">
										<label class="col-12 col-form-label">Slug</label>
										<div class="col-12">
											{{ form.slug }}
											<small>The slug must be lowercase and use hyphens only.</small>
											{% if form.slug.errors %}
											<div class="text-danger mt-1">{{ form.slug.errors }}</div>
											{% endif %}
										</div>
									</div>

									<div class="form-group row">
										<label class="col-12 col-form-label">Short Description</label>
										<div class="col-12">
											{{ form.short_description }}
										</div>
									</div>

									<div class="form-group row">
										<label class="col-12 col-form-label">Full Description</label>
										<div class="col-12">
											{{ form.full_description }}
										</div>
									</div>

									<div class="form-group row">
										<label class="col-12 col-form-label">Product Tags</label>
										<div class="col-12">
											{{ form.tags }}
										</div>
									</div>

									<div class="form-group row">
										<label class="col-12 col-form-label">Parent Category</label>
										<div class="col-12">
											{{ form.category }}
										</div>
									</div>

									<div class="form-group row">
										<label class="col-12 col-form-label">Status</label>
										<div class="col-12">
											{{ form.status }}
										</div>
									</div>

									<div class="form-group row">
										<label class="col-12 col-form-label">Trending</label>
										<div class="col-12">
											{{ form.trending }}
										</div>
									</div>

									{% if editing %}
									<button type="submit" class="btn btn-warning">Update</button>
									<a href="{% url 'subcategory_list' %}" class="btn btn-secondary">Cancel</a>
									{% else %}
									<button type="submit" class="btn btn-primary">Submit</button>
									{% endif %}

								</form>
							</div>
						</div>
					</div>
				</div>
				<div class="col-xl-8 col-lg-12">
					<div class="ec-cat-list card card-default">
						<div class="card-body">
							<div class="table-responsive">
								<table id="responsive-data-table" class="table">
									<thead>
										<tr>
											{% comment %} <th>Thumb</th> {% endcomment %}
											<th>Name</th>
											<th>Main Categories</th>
											<th>Status</th>
											<th>Trending</th>
											<th>Action</th>
										</tr>
									</thead>

									<tbody>
										{% for sub in subcategories %}
										<tr>

											<!-- Static Thumb -->
											{% comment %} <td>
												<img class="cat-thumb"
													src="{% static 'assets/img/category/default-thumb.png' %}"
													alt="Subcategory Image">
											</td> {% endcomment %}

											<td>{{ sub.name }}</td>

											<td>{{ sub.category.name }}</td>

											<td>
												{% if sub.status == 'active' %}
												<span class="badge badge-success">ACTIVE</span>
												{% else %}
												<span class="badge bg-danger">INACTIVE</span>
												{% endif %}
											</td>

											<td>
												{% if sub.trending == 'top' %}
												<span class="badge badge-success">TOP</span>
												{% elif sub.trending == 'medium' %}
												<span class="badge bg-primary">MEDIUM</span>
												{% else %}
												<span class="badge bg-danger">LOW</span>
												{% endif %}
											</td>

											<td>
												<div class="btn-group">
													<a href="{% url 'subcategory_edit' sub.id %}"
														class="dropdown-item">Edit</a>
													<a href="{% url 'subcategory_delete' sub.id %}"
														class="dropdown-item text-danger"
														onclick="return confirm('Delete this category?');">Delete</a>
												</div>
											</td>

										</tr>
										{% endfor %}
									</tbody>

								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div> <!-- End Content -->
	</div> <!-- End Content Wrapper -->

	{% endblock content %}